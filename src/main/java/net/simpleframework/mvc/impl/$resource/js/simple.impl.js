var $MessageConst={"$Loading.0":"\u88c5\u8f7d\u4e2d...","SaveOK":"\u64cd\u4f5c\u6210\u529f","Button.Ok":"\u786e\u8ba4","Button.Cancel":"\u53d6\u6d88","Button.Delete":"\u5220\u9664","Button.More":"\u66f4\u591a","Button.Less":"\u66f4\u5c11","Button.Location.Reload":"\u91cd\u65b0\u88c5\u8f7d\u5f53\u524d\u9875\u9762","Alert.Title":"\u4fe1\u606f","Confirm.Title":"\u786e\u8ba4","Error.Title":"\u7cfb\u7edf\u4fe1\u606f","Error.delete2":"\u81f3\u5c11\u8981\u9009\u62e9\u4e00\u4e2a\u6761\u76ee","Error.Move":"\u65e0\u6cd5\u79fb\u52a8\u5230\u6307\u5b9a\u4f4d\u7f6e","Tree.dropConfirm":"\u662f\u5426\u786e\u8ba4\u62d6\u653e\u64cd\u4f5c","ImageSlide.0":"\u6253\u5f00\u56fe\u7247","ImageSlide.1":"\u542f\u52a8\u64ad\u653e","ImageSlide.2":"\u505c\u6b62\u64ad\u653e","ValidateCode.0":"\u770b\u4e0d\u6e05\u695a\uff0c\u518d\u6362\u4e00\u5f20","Table.Draggable.0":"\u6b63\u5728\u62d6\u52a8","Table.Draggable.1":"\u4e2a\u9879\u76ee","TablePager.0":"\u8f93\u5165\u6761\u4ef6","TablePager.1":"\u8bf7\u9009\u62e9\u8981\u64cd\u4f5c\u7684\u6761\u76ee\uff01","Progressbar.0":"\u4e2d\u6b62","Progressbar.1":"\u8be6\u7ec6\u4fe1\u606f","Progressbar.2":"\u6e05\u9664\u6240\u6709","Progressbar.3":"\u4e0e\u670d\u52a1\u5668\u540c\u6b65\u4fe1\u606f","Progressbar.4":"\u7981\u6b62\u6eda\u52a8","Progressbar.5":"\u5173\u95ed","PwdStrength.0":["\u975e\u5e38\u5f31","\u5f31","\u7a0d\u5f31","\u4e00\u822c","\u7a0d\u5f3a","\u5f3a","\u975e\u5e38\u5f3a","\u5b8c\u7f8e"],"Calendar.0":"\u65e5 \u4e00 \u4e8c \u4e09 \u56db \u4e94 \u516d","Calendar.1":"\u4eca\u5929","Calendar.2":"\u6e05\u9664"};

var $ready=function(callback){if(document.loaded){callback.delay(0.1,document)}else{document.observe("dom:loaded",callback)}};(function(){Object.extend(Browser,Prototype.Browser);Object.extend(Browser,{effects:window.IS_EFFECTS&&!Object.isUndefined(window.Effect),WebKit419:Browser.WebKit&&!document.evaluate});if(Browser.IE){Browser.IEVersion=parseFloat(navigator.appVersion.split(";")[1].trim().split(" ")[1])}var $bak=$;window.$=function(element){if(typeof element=="string"&&element.length>0&&(element[0]=="."||element[0]=="#")){var elements=$$(element);return elements.length>0?elements[0]:undefined}else{var elements;return $bak(element)||((elements=$$(element)).length>0?elements[0]:undefined)}};var $Fbak=$F;window.$F=function(element){element=$(element);return element?$Fbak(element):""}})();window.$Form=function(form){return $Elements(form).inject([],function(results,o){results.push(Form.Methods.serialize(o));return results}).join("&")};window.$Elements=function(object){if(Object.isString(object)){return $$(object)}else{if(Object.isArray(object)){return object}else{if(Object.isElement(object)){if(object=$(object)){var r=[];r.push(object);return r}}}}return[]};window.$Target=function(o){o=$(o);return(o&&o.getTargetObject)?o.getTargetObject():o};Object.extend($Actions,{valueBinding:function(json,callback){if(!json){return}var f=function(key){var element=$(key);var v=json[key];if(element&&v!=null&&v!=="undefined"){this.setValue(element,v)}}.bind(this);(function(){Object.keys(json).each(f);$call(callback)}).delay(0.1)},setValue:function(element,v,insert){element=$(element);if(!element){return}if(element.htmlEditor){if(insert){if(Object.isElement(v)){element.htmlEditor.insertElement(CKEDITOR.dom.element.get(v))}else{element.htmlEditor.insertHtml(v)}}else{element.htmlEditor.setData(v)}}else{var tag=element.tagName.toUpperCase();if(tag=="SELECT"&&Object.isNumber(v)){element.selectedIndex=v}else{if(tag=="SPAN"||tag=="LABEL"){element.innerHTML=v}else{if(tag=="TEXTAREA"&&insert){if(document.selection){element.focus();sel=document.selection.createRange();sel.text=v}else{if(element.selectionStart||element.selectionStart=="0"){var start=element.selectionStart;var end=element.selectionEnd;var v2=element.value;element.setValue(v2.substring(0,start)+v+v2.substring(end,v2.length))}else{element.setValue(element.value+v)}}}else{element.setValue(v)}}}if(tag=="SELECT"&&element.hasAttribute("readonly")){var r=new Element("span",{"className":"readonly"});r.innerHTML=element.options[element.selectedIndex].text;element.replace(r)}if(element.getAttribute("autorows")=="true"){element.style.height="0px";element.style.height=element.scrollHeight+"px"}}},addHidden:function(form,params){if(!form||!params){return}$H(params.toQueryParams()).each(function(pair){var hidden=form.down("#"+pair.key);if(Object.isElement(hidden)&&hidden.tagName.toUpperCase()=="INPUT"&&hidden.type=="hidden"){hidden.value=pair.value}else{form.insert(new Element("INPUT",{type:"hidden",id:pair.key,name:pair.key,value:pair.value}))}})},visibleToggle:function(element){if(Object.isString(element)){$$(element).each(function(eobj){eobj.toggle()})}else{if(Object.isElement(element)){element.toggle()}}},readonly:function(element){if(Object.isString(element)){$$(element).each(function(eobj){$Actions.readonly(eobj)})}else{if(Object.isElement(element)){if(/input|textarea/i.test(element.tagName)){element.readOnly=true}else{Form.getElements(element).each(function(eobj){$Actions.readonly(eobj)})}}}},disable:function(element){this._enable_disable(element)},enable:function(element){this._enable_disable(element,true)},_enable_disable:function(element,enable){var method=enable?"enable":"disable";if(Object.isString(element)){$$(element).each(function(eobj){$Actions[method](eobj)})}else{if(Object.isElement(element)){if(/input|select|textarea|button/i.test(element.tagName)){element[method]()}else{Form.Methods[method](element)}}}},observeSubmit:function(selector,sFunc){$Elements(selector).invoke("observe","keydown",function(ev){var code=(ev.which)?ev.which:ev.keyCode;if(code==Event.KEY_RETURN){sFunc(Event.element(ev))}})}});Object.extend(Form.Element.Serializers,{textarea:function(element,value){if(Object.isUndefined(value)){if(element.htmlEditor){element.htmlEditor.updateElement()}return element.value}else{element.value=value}}});Object.extend(String.prototype,{addSelectorParameter:function(selector){var str=this.toString();if(selector){if(Object.isElement(selector)){str=str.addParameter($Form(selector))}else{var elements=$$(selector);if(elements){for(var i=0;i<elements.length;i++){str=str.addParameter($Form(elements[i]))}}}}return str},camelcase:function(){var string=this.dasherize().camelize();return string.charAt(0).toUpperCase()+string.slice(1)}});Object.extend(document.viewport,{setScrollOffsets:function(offset){Element.setScrollOffsets(Prototype.Browser.WebKit?document.body:document.documentElement,offset)},getScrollDimensions:function(){return Element.getScrollDimensions(Prototype.Browser.WebKit?document.body:document.documentElement)
}});Element.addMethods({getScrollDimensions:function(element){return{width:element.scrollWidth,height:element.scrollHeight}},setDimensions:function(element){var h,w;var opt=arguments[1];if(typeof opt=="object"){h=opt.height;w=opt.width}else{h=opt;w=arguments[2]}var f=function(p){if(Object.isNumber(p)){return p+"px"}else{return Object.isString(p)?(p.strip().endsWith("%")?p:parseInt(p)+"px"):"auto"}};var opt2={};if(h){opt2.height=f(h)}if(w){opt2.width=f(w)}if($H(opt2).size()>0){element.setStyle(opt2)}},getScrollOffsets:function(element){return Element._returnOffset(element.scrollLeft,element.scrollTop)},setScrollOffsets:function(element,offset){if(arguments.length==3){offset={left:offset,top:arguments[2]}}element.scrollLeft=offset.left;element.scrollTop=offset.top;return element},appendText:function(element,text){text=String.interpret(text);element.appendChild(document.createTextNode(text));return element},createDrag:function(element){element.enableDrag();var t=0,l=0;element.observe("drag:started",function(p){t=parseInt(element.style.top);l=parseInt(element.style.left)}).observe("drag:updated",function(p){element.style.top=t+p.memo.dy+"px";element.style.left=l+p.memo.dx+"px"})},enableDrag:function(element){element.writeAttribute("draggable","true");return element},disableDrag:function(element){element.writeAttribute("draggable",null);return element},isDraggable:function(element){return element.readAttribute("draggable")=="true"},fixOnSelectStart:function(element,remove){if(remove){if(Browser.Gecko){element.style.removeProperty("-moz-user-select")}else{element.removeAttribute("onselectstart")}}else{if(Browser.Gecko){element.setStyle("-moz-user-select: none;")}else{element.setAttribute("onselectstart","return false;")}}return element},setPngBackground:function(element,src){var f=Object.extend({align:"top left",repeat:"no-repeat",sizingMethod:"scale",backgroundColor:""},arguments[2]||{});element.setStyle((Browser.IEVersion&&Browser.IEVersion<=6)?{filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+src+"'', sizingMethod='"+f.sizingMethod+"')"}:{background:f.backgroundColor+" url("+src+") "+f.align+" "+f.repeat});return element},observeImageLoad:function(img,callback){if(img.tagName!=="IMG"){return}img.onreadystatechange=img.onload=function(){var state=img.readyState;if(callback&&((state&&(state=="complete"||state=="loaded"))||img.complete==true)){callback()}};return img},clearImageLoad:function(img){img.onreadystatechange=img.onload=null;return img}});Object.extend($Effect,{shake:function(element,options){options=options||{};if(options.effects||Browser.effects){var win;if(window.$win&&(win=window.$win(element))){win.content.setStyle("overflow: hidden;")}element.shake(Object.extend({duration:0.5},options||{}));(function(){if(win){win.content.setStyle("overflow: auto;")}}).delay(0.6)}return element},highlight:function(element,color,options){if(element.set_style){return element}element.set_style=true;options=options||{};if(options.effects||Browser.effects){var aFinish=options.afterFinish;options.afterFinish=function(){$call(aFinish);element.set_style=false};var ocolor=element.getStyle("background-color").parseColor("#FFFFFF");element.highlight(Object.extend({duration:1,startcolor:ocolor,endcolor:color},options))}else{var bg=element.getStyle("background");element.setStyle("background: "+color);(function(){element.setStyle("background: "+(bg?bg:"none"));$call(options.afterFinish);element.set_style=false}).delay(1)}return element},opacity:function(element,options){options=options||{};if(options.effects||Browser.effects){new Effect.Opacity(element,Object.extend({duration:0.1,transition:Effect.Transitions.linear},options||{}))}return element},slideDown:function(element,options){if(element.visible()){return}options=options||{};if(options.effects||Browser.effects){element.slideDown(Object.extend({duration:0.2},options))}else{element.show();$call(options.afterFinish)}return element},blindUp:function(element,options){if(!element.visible()){return}options=options||{};if(options.effects||Browser.effects){element.blindUp(Object.extend({duration:0.2},options))}else{element.hide();$call(options.afterFinish)}return element},style:function(element,style,options){options=options||{};if(options.effects||Browser.effects){new Effect.Morph(element,Object.extend({"duration":0.4,"style":style},options))}else{element.setStyle(style);$call(options.afterFinish)}return element},remove:function(element){return this.blindUp(element,{duration:0.2,afterFinish:function(){element.remove()}})},show:function(element,options){if(element.visible()){return}options=options||{};if(options.effects||Browser.effects){element.appear(Object.extend({duration:0.25},options))}else{element.show();$call(options.afterFinish)}return element},hide:function(element,options){if(!element.visible()){return}options=options||{};if(options.effects||Browser.effects){element.fade(Object.extend({duration:0.2},options))}else{element.hide();$call(options.afterFinish)
}return element},toggle:function(element,options){return this[element.visible()?"hide":"show"](element,options)}});(function(){var initPointer,currentDraggable,dragging=false;function onMousedown(event){var draggable=event.findElement('[draggable="true"]');if(!draggable){return}var element=event.element();if(element&&element.tagName=="DIV"){Event.stop(event);currentDraggable=draggable;initPointer=event.pointer();document.observe("mousemove",onMousemove).observe("mouseup",onMouseup)}}function onMousemove(event){Event.stop(event);if(dragging){fire("drag:updated",event)}else{dragging=true;fire("drag:started",event)}}function onMouseup(event){Event.stop(event);document.stopObserving("mousemove",onMousemove).stopObserving("mouseup",onMouseup);if(dragging){dragging=false;fire("drag:ended",event)}}function fire(eventName,mouseEvent){var pointer=mouseEvent.pointer();currentDraggable.fire(eventName,{dx:pointer.x-initPointer.x,dy:pointer.y-initPointer.y,mouseEvent:mouseEvent})}document.observe("keydown",function(ev){var code=(ev.which)?ev.which:ev.keyCode;if(ev.ctrlKey&&code==Event.KEY_RETURN){var arr=$$("input[key=ctrlReturn]");if(arr&&arr.length>0){arr[0].click()}}});document.observe("mousedown",onMousedown)})();(function(){var eventMatchers={"HTMLEvents":/^(?:load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll)$/,"MouseEvents":/^(?:click|mouse(?:down|up|over|move|out))$/};var defaultOptions={pointerX:0,pointerY:0,button:0,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,bubbles:true,cancelable:true};Event.simulate=function(element,eventName){var options=Object.extend(defaultOptions,arguments[2]||{});var oEvent,eventType=null;element=$(element);for(var name in eventMatchers){if(eventMatchers[name].test(eventName)){eventType=name;break}}if(!eventType){throw new SyntaxError("Only HTMLEvents and MouseEvents interfaces are supported")}if(document.createEvent){oEvent=document.createEvent(eventType);if(eventType=="HTMLEvents"){oEvent.initEvent(eventName,options.bubbles,options.cancelable)}else{oEvent.initMouseEvent(eventName,options.bubbles,options.cancelable,document.defaultView,options.button,options.pointerX,options.pointerY,options.pointerX,options.pointerY,options.ctrlKey,options.altKey,options.shiftKey,options.metaKey,options.button,element)}element.dispatchEvent(oEvent)}else{options.clientX=options.pointerX;options.clientY=options.pointerY;oEvent=Object.extend(document.createEventObject(),options);element.fireEvent("on"+eventName,oEvent)}return element};Element.addMethods({simulate:Event.simulate})})();

(function(){if(isMobile.ios()){var createIframe=function(){var iframe=document.createElement("IFRAME");iframe.style.display="none";iframe.setAttribute("src","data:text/plain,");document.documentElement.appendChild(iframe);return iframe};window.alert=function(message){var iframe=createIframe();iframe.contentWindow.window.alert(message);iframe.parentNode.removeChild(iframe)};window.confirm=function(message){var iframe=createIframe();var result=iframe.contentWindow.window.confirm(message);iframe.parentNode.removeChild(iframe);return result}}window.$alert=function(msg,title,h){var w=new UI.Window({minimize:false,maximize:false,resizable:false,height:(h||160),width:420,theme:"popup"});w.element.setStyle({zIndex:99999});var c=("<div class='sy_alert_dialog'>"+"<div class='top'><div class='img'></div>"+"<div class='txt wrap_text' style='height: "+(w.options.height-113)+"px;'>"+msg+"</div></div><div class='btn'></div></div>").makeElement();c.down(".btn").insert(new Element("input",{type:"button",value:$MessageConst["Button.Ok"]}).observe("click",function(evn){w.close()}));w.setHeader(title||$MessageConst["Alert.Title"]).setContent(c);w.center().show(true).activate()};window.$confirm=function(msg,okCallback,cancleCallback){var w=new UI.Window({minimize:false,maximize:false,resizable:false,height:160,width:450,theme:"popup"});var c=("<div class='sy_confirm_dialog'>"+"<div class='top'><div class='img'></div>"+"<div class='txt wrap_text'>"+msg+"</div></div><div class='btn'></div></div>").makeElement();c.down(".btn").insert(new Element("input",{type:"button",value:$MessageConst["Button.Ok"]}).observe("click",function(evn){$call(okCallback);w.close()})).insert(new Element("input",{type:"button",style:"margin-left: 4px;",value:$MessageConst["Button.Cancel"]}).observe("click",function(evn){$call(cancleCallback);w.close()}));w.setHeader($MessageConst["Confirm.Title"]).setContent(c);w.center().show(true).activate()};window.$error=function(err,alertType){if(!window.WINDOW_UI_ENABLE||alertType){alert(err.title)}else{if(typeof err=="string"){alert(err);return}if(!this.errWindows){this.errWindows={}}var _WIDTH=600;var _HEIGHT=160;var w;if(this.errWindows[err.hash]){w=this.errWindows[err.hash]}else{w=this.errWindows[err.hash]=new UI.Window({minimize:false,maximize:false,width:_WIDTH,height:_HEIGHT,theme:"popup"});w.observe("hidden",function(){delete this.errWindows[err.hash]}.bind(this))}var c=new Element("div",{className:"sy_error_dialog"}).insert(new Element("div",{className:"et wrap_text"}).update((err.title||"").convertHtmlLines()));var right=new Element("div",{style:"float: right;"});if(err["more"]){var detail=new Element("div");c.insert(detail);right.insert(new Element("input",{type:"button",style:"margin-right: 6px;",value:$MessageConst["Button.More"]}).observe("click",function(){if(detail.down()){detail.update("");this.value=$MessageConst["Button.More"];w.setSize(_WIDTH,_HEIGHT).adapt()}else{var ta=new Element("textarea",{readonly:"readonly"});ta.setValue(err.detail);detail.update(new Element("div",{className:"ta"}).insert(ta));this.value=$MessageConst["Button.Less"];w.adapt()}w.center()}))}right.insert(new Element("input",{type:"button",value:$MessageConst["Button.Cancel"]}).observe("click",function(){w.close()}));c.insert(new Element("div",{className:"eb"}).insert(right).insert(new Element("div",{style:"float: left"}).insert(new Element("a",{href:"#"}).update($MessageConst["Button.Location.Reload"]).observe("click",function(){location.reload()}))));w.setHeader($MessageConst["Error.Title"]).setContent(c);w.center().show(true).activate()}};$ready(function(){window.WINDOW_UI_ENABLE=window.UI&&window.UI.Window;var $alert_bak=window._alert=window.alert;window.alert=function(msg){if(!window.WINDOW_UI_ENABLE){$alert_bak(msg)}else{$alert(msg)}}})})();Object.extend($UI,{getPopupOffsets:function(popup,trigger){if(!trigger){var e=document.getEvent();if(!e||!(trigger=Event.element(e))){return[0,0]}}if(window.$Target){trigger=$Target(trigger)}var tl=trigger.cumulativeOffset();var valueT=tl.top,valueL=tl.left;valueT=valueT+trigger.getDimensions().height;tl=trigger.cumulativeScrollOffset();valueT-=tl.top,valueL-=tl.left;var bodyDelta=35;var vpDim=document.viewport.getDimensions();var bodyWidth=vpDim.width-bodyDelta;var bodyHeight=vpDim.height-bodyDelta;var popupWidth,popupHeight;if(Object.isElement(popup)){popup=$(popup);popupWidth=popup.getWidth();popupHeight=popup.getHeight()}else{popupWidth=popup.width;popupHeight=popup.height}if(valueL+popupWidth>bodyWidth){var d=bodyWidth-popupWidth;valueL=d<0?2:d}if(valueT+popupHeight>bodyHeight){var d=bodyHeight-popupHeight;valueT=d<0?2:d}var vpOff=document.viewport.getScrollOffsets();valueT+=vpOff.top;valueL+=vpOff.left;return[valueL,valueT+1]},doImageToggle:function(image,target,options){if(!(image=$(image))){return}if(!(target=$(target))){target=image.up().next()}var src=image.src;if(!src){return}image.setStyle("cursor:pointer;border:0px");options=Object.extend({cookie:false,open:true,onShow:Prototype.emptyFunction,onHide:Prototype.emptyFunction},options);
var p=src.lastIndexOf("/")+1;var path=src.substring(0,p);var file=src.substring(p);var doImage=function(){if(target.visible()){if(!file.startsWith("p_")){file="p_"+file}}else{if(file.startsWith("p_")){file=file.substring(2)}}image.src=path+file;if(options.cookie){document.setCookie("toggle_"+image.identify(),target.visible())}};var _show=options.open;if(options.cookie){_show=(document.getCookie("toggle_"+image.identify())=="true")}if(_show){target.show()}else{target.hide()}image.observe("click",function(){if(target.visible()){target.hide();doImage();if(options.onHide){options.onHide()}}else{target.show();doImage();if(options.onShow){options.onShow()}}});doImage()},addBackgroundTitle:function(txt,TITLE){txt=$(txt);if(!txt){return}if("placeholder" in txt){txt.setAttribute("placeholder",TITLE);return}var c=txt.getStyle("color");var f=function(ev){if($F(txt)==""){txt.setValue(TITLE)}if($F(txt)==TITLE){txt.setStyle("color: #ddd;")}};txt.observe("focus",function(ev){if($F(txt)==TITLE){txt.setValue("");txt.setStyle("color:"+c)}});txt.observe("blur",f);f()},addReturnEvent:function(txt,func){txt.observe("keypress",function(ev){if(((ev.which)?ev.which:ev.keyCode)!=Event.KEY_RETURN){return}if(func){func(ev)}})},enableDragDrop:function(container,hoverclass,callback){if(!Object.isArray(container)){container=$(container);if(!container){return}container=container.select(".drag_image")}callback=callback||{};container.each(function(a){new Draggable(a,{revert:true,scroll:callback.scroll||window,onStart:function(){a.addClassName("drag_tooltip");a.drops=Droppables.drops.clone();Droppables.drops=Droppables.drops.reject(function(d){return d.hoverclass!=hoverclass});if(callback.onStart){callback.onStart(a)}},onEnd:function(){a.removeClassName("drag_tooltip");a.update("");Droppables.drops=a.drops;if(callback.onEnd){callback.onEnd(a)}}})})},shakeMsg:function(o,msg){o.innerHTML=msg;$Effect.shake(o,{afterFinish:function(){o.innerHTML=""}.delay(5)})}});Object.extend($UI,{createLink:function(text,options,click){options=Object.extend({href:(Browser.IEVersion&&Browser.IEVersion<=6)?"###":"javascript:void(0);"},options||{});if(Browser.IEVersion&&Browser.IEVersion<=7){options=Object.extend(options,{hideFocus:true})}var a=new Element("a",options);if(text){a.update(text)}if(click){a.observe("click",click)}return a},createTable:function(options){options=Object.extend({width:"100%",cellpadding:"0",cellspacing:"0"},options||{});return new Element("table",options).insert(new Element("tbody"))},createSplitbar:function(bar,left,callback){if(!(bar=$(bar))||!(left=$(left))){return}var p,w,ow=left.getWidth();bar.observe("dblclick",function(evt){left.setStyle("width: "+ow+"px")});var mousemove=function(evt){if(!p){return}var nw=w-p.x+evt.pointer().x;if(nw<50||nw>(document.viewport.getWidth()-50)){return}left.setStyle("width: "+nw+"px");$call(callback,nw);bar.fire("size:splitbar");Event.stop(evt)};var mouseup=function(evt){if(!p){return}$(document.body).fixOnSelectStart(true);document.stopObserving("mousemove",mousemove);document.stopObserving("mouseup",mouseup);p=null};bar.observe("mousedown",function(evt){$(document.body).fixOnSelectStart();p=evt.pointer();w=left.getWidth();document.observe("mousemove",mousemove);document.observe("mouseup",mouseup)})},createButtonInputField:function(textId,bFunc,readonly,editable){var element=new Element("div",{className:"text text_button"});element.textInput=new Element("input",{type:"text"});if(readonly||!editable){element.textInput.readOnly=true}if(textId){element.textInput.id=element.textInput.name=textId}element.insert(new Element("div",{className:"d1"}).insert(new Element("div",{className:"d2"}).insert(element.textInput)));if(!readonly){element.insert(element.textButton=new Element("div",{className:"sbtn"}).observe("click",function(ev){if(bFunc){bFunc(ev)}}))}return element},createFileInputField:function(){var tb=this.createButtonInputField();var f=new Element("input",{type:"file",hidefocus:"hidefocus",size:"1"}).observe("change",function(e){tb.textInput.value=f.value});tb.textInput.observe("change",function(e){if(tb.textInput.value==""){var up=f.up();new Element("form").insert(f).reset();up.insert(f)}});var ele=new Element("div",{className:"text_file_button"}).insert(tb).insert(f);ele.file=f;ele.textButton=tb;return ele},createMultiSelectInputField:function(textId,bFunc,readonly){var r=new Element("div",{className:"multi_dselect"});var hidden=new Element("input",{type:"hidden"});if(textId){hidden.id=hidden.name=textId}r.insert(hidden);if(!readonly){r.insert(r.textButton=new Element("SPAN",{className:"sbtn"}).observe("click",function(ev){if(bFunc){bFunc(r,ev)}}))}this.multiSelectInputField_init(r,readonly);return r},multiSelectInputField_init:function(r,readonly){var updateHidden=function(){r.down("input").value=r.select(".item").inject([],function(ret,o){ret.push(o.id);return ret}).join(";")};r.insertItem=function(id,txt,className){if(r.select(".item").find(function(o){return o.id==id})){return}var item;r.insert(item=new Element("SPAN",{className:"item"+(className?" "+className:""),id:id}).update(txt));
if(!readonly){item.insert(new Element("SPAN",{className:"del"}).observe("click",function(ev){item.remove();updateHidden()}))}else{item.setStyle("padding-right: 8px;")}updateHidden()}},pwdStrength_update:function(m,input,effects){input=$(input);if(!input){return}m=$(m);if(!m){return}input.observe("keyup",function(){var score=0;var passwd=$F(input);for(var i=0;i<passwd.length;i++){var c=passwd.charAt(i);if(c>="a"&&c<="z"){score+=2}if(c>="0"&&c<="9"){score+=3}if(c>="A"&&c<="Z"){score+=4}if(c.match(/[!,@#$%^&*?_~]/)){score+=5}}var width=score*2.2;if(width>100){width=100}var pwds=m.down(".pwds");$Effect.style(pwds,"width:"+width+"px",{"effects":effects});var lbl=m.down(".lbl");if(score>0){var i;if(score<4){i=0}else{if(score<=10){i=1}else{if(score<=15){i=2}else{if(score<=20){i=3}else{if(score<=25){i=4}else{if(score<=30){i=5}else{if(score<=40){i=6}else{i=7}}}}}}}lbl.update($MessageConst["PwdStrength.0"][i])}else{lbl.update("")}})},doTabButtonsTooltip:function(selector){if(!window.Tip){return}$$(selector).each(function(li){var d=li.down(".tt");if(!d){return}new Tip(li,d.innerHTML,{stem:"rightTop",hideOthers:true,delay:0.5,hideAfter:0.5,width:210,hook:{target:"leftTop",tip:"rightTop"},hideOn:{element:"tip",event:"mouseleave"}})})},doMobileSentInterval:function(obj,create){var id=(typeof obj=="string")?obj:obj.identify();var _obj=$(id);var _sent;if(create){_sent=window["_sent_"+id]={min:60,txt:_obj.value}}if(!_sent){return}if(!_sent.hdl){_sent.hdl=setInterval(function(){_sent.min--;var _obj=$(id);if(!_obj){return}if(_sent.min==0){_obj.value=_sent.txt;_obj.enable();clearTimeout(_sent.hdl);_sent.hdl=null}else{_obj.value=_sent.txt+"("+_sent.min+")";_obj.disable()}},1000)}}});Object.extend($UI,{disableBackspace:function(){document.observe("keydown",function(ev){var code=(ev.which)?ev.which:ev.keyCode;if(code==Event.KEY_BACKSPACE){var ele=Event.element(ev);if(Object.isElement(ele)&&/input|textarea/i.test(ele.tagName)){var disabled=ele.disabled||ele.readOnly;if(!disabled){return true}}Event.stop(ev);return false}})},hackCheckbox:function(selector){$Elements(selector).each(function(c){c.select("input[type=checkbox]").invoke("observe","click",function(evn){evn.stopPropagation()})})},fixTextareaTab:function(selector){$Elements(selector).each(function(ta){var tag=ta.tagName.toUpperCase();if(tag!="TEXTAREA"){return}ta.observe("keydown",function(evn){var keyCode=evn.keyCode||evn.which;if(keyCode==9){if(document.selection){var range=document.selection.createRange();range.text="\t"}else{var val=this.value,start=this.selectionStart,end=this.selectionEnd;this.value=val.substring(0,start)+"\t"+val.substring(end);this.selectionStart=this.selectionEnd=start+1}evn.preventDefault()}})})}});